W0712 07:14:19.311866 3433070 torch/distributed/run.py:766] 
W0712 07:14:19.311866 3433070 torch/distributed/run.py:766] *****************************************
W0712 07:14:19.311866 3433070 torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0712 07:14:19.311866 3433070 torch/distributed/run.py:766] *****************************************
torch cuda available: True
/home/ubuntu/MyFiles/d2l/.venv/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
[rank2]:[W712 07:14:22.485966225 ProcessGroupNCCL.cpp:4718] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
torch cuda available: True
torch cuda available: True
/home/ubuntu/MyFiles/d2l/.venv/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
torch cuda available: True
/home/ubuntu/MyFiles/d2l/.venv/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
[rank1]:[W712 07:14:22.685233000 ProcessGroupNCCL.cpp:4718] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
[rank0]:[W712 07:14:22.685266199 ProcessGroupNCCL.cpp:4718] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
/home/ubuntu/MyFiles/d2l/.venv/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
[rank3]:[W712 07:14:22.762678520 ProcessGroupNCCL.cpp:4718] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
Rank 2 loaded data with 60000 training samples and 10000 test samples.
Rank 1 loaded data with 60000 training samples and 10000 test samples.
Rank 0 loaded data with 60000 training samples and 10000 test samples.
Rank 3 loaded data with 60000 training samples and 10000 test samples.
Epoch 001/100, Train Loss: 2.3077, Train Accuracy: 0.1000, Test Accuracy: 0.1000
Epoch 002/100, Train Loss: 2.3044, Train Accuracy: 0.1051, Test Accuracy: 0.0911
Epoch 003/100, Train Loss: 2.3018, Train Accuracy: 0.1340, Test Accuracy: 0.1131
Epoch 004/100, Train Loss: 2.2963, Train Accuracy: 0.1310, Test Accuracy: 0.1050
Epoch 005/100, Train Loss: 2.2800, Train Accuracy: 0.1866, Test Accuracy: 0.2185
Epoch 006/100, Train Loss: 2.2119, Train Accuracy: 0.1866, Test Accuracy: 0.1970
Epoch 007/100, Train Loss: 1.9794, Train Accuracy: 0.2116, Test Accuracy: 0.2835
Epoch 008/100, Train Loss: 1.8067, Train Accuracy: 0.2833, Test Accuracy: 0.2747
Epoch 009/100, Train Loss: 1.7672, Train Accuracy: 0.3510, Test Accuracy: 0.1939
Epoch 010/100, Train Loss: 1.7136, Train Accuracy: 0.3603, Test Accuracy: 0.4249
Epoch 011/100, Train Loss: 1.4508, Train Accuracy: 0.4463, Test Accuracy: 0.5043
Epoch 012/100, Train Loss: 1.2566, Train Accuracy: 0.5191, Test Accuracy: 0.5042
Epoch 013/100, Train Loss: 1.0246, Train Accuracy: 0.6171, Test Accuracy: 0.6745
Epoch 014/100, Train Loss: 0.9178, Train Accuracy: 0.6508, Test Accuracy: 0.6535
Epoch 015/100, Train Loss: 0.8447, Train Accuracy: 0.6754, Test Accuracy: 0.7132
Epoch 016/100, Train Loss: 0.7853, Train Accuracy: 0.7026, Test Accuracy: 0.5771
Epoch 017/100, Train Loss: 1.2016, Train Accuracy: 0.5770, Test Accuracy: 0.4311
Epoch 018/100, Train Loss: 0.8575, Train Accuracy: 0.6713, Test Accuracy: 0.7288
Epoch 019/100, Train Loss: 0.7098, Train Accuracy: 0.7321, Test Accuracy: 0.7481
Epoch 020/100, Train Loss: 0.6713, Train Accuracy: 0.7454, Test Accuracy: 0.7641
Epoch 021/100, Train Loss: 0.6370, Train Accuracy: 0.7569, Test Accuracy: 0.7700
Epoch 022/100, Train Loss: 0.6276, Train Accuracy: 0.7636, Test Accuracy: 0.7848
Epoch 023/100, Train Loss: 0.5937, Train Accuracy: 0.7771, Test Accuracy: 0.7784
Epoch 024/100, Train Loss: 0.5890, Train Accuracy: 0.7789, Test Accuracy: 0.7994
Epoch 025/100, Train Loss: 0.5677, Train Accuracy: 0.7841, Test Accuracy: 0.7956
Epoch 026/100, Train Loss: 0.5524, Train Accuracy: 0.7943, Test Accuracy: 0.7989
Epoch 027/100, Train Loss: 0.5332, Train Accuracy: 0.7999, Test Accuracy: 0.7966
Epoch 028/100, Train Loss: 0.5214, Train Accuracy: 0.8058, Test Accuracy: 0.7874
Epoch 029/100, Train Loss: 0.5188, Train Accuracy: 0.8055, Test Accuracy: 0.7669
Epoch 030/100, Train Loss: 0.5019, Train Accuracy: 0.8126, Test Accuracy: 0.8133
Epoch 031/100, Train Loss: 0.4934, Train Accuracy: 0.8161, Test Accuracy: 0.8310
Epoch 032/100, Train Loss: 0.4767, Train Accuracy: 0.8223, Test Accuracy: 0.8181
Epoch 033/100, Train Loss: 0.4722, Train Accuracy: 0.8236, Test Accuracy: 0.8067
Epoch 034/100, Train Loss: 0.4557, Train Accuracy: 0.8310, Test Accuracy: 0.8323
Epoch 035/100, Train Loss: 0.4543, Train Accuracy: 0.8311, Test Accuracy: 0.8043
Epoch 036/100, Train Loss: 0.4403, Train Accuracy: 0.8364, Test Accuracy: 0.8441
Epoch 037/100, Train Loss: 0.4303, Train Accuracy: 0.8405, Test Accuracy: 0.8455
Epoch 038/100, Train Loss: 0.4328, Train Accuracy: 0.8384, Test Accuracy: 0.8349
Epoch 039/100, Train Loss: 0.4223, Train Accuracy: 0.8442, Test Accuracy: 0.8531
Epoch 040/100, Train Loss: 0.4107, Train Accuracy: 0.8476, Test Accuracy: 0.8562
Epoch 041/100, Train Loss: 0.4068, Train Accuracy: 0.8473, Test Accuracy: 0.8442
Epoch 042/100, Train Loss: 0.3982, Train Accuracy: 0.8528, Test Accuracy: 0.8013
Epoch 043/100, Train Loss: 0.4006, Train Accuracy: 0.8532, Test Accuracy: 0.8541
Epoch 044/100, Train Loss: 0.3871, Train Accuracy: 0.8565, Test Accuracy: 0.8591
Epoch 045/100, Train Loss: 0.3812, Train Accuracy: 0.8595, Test Accuracy: 0.8286
Epoch 046/100, Train Loss: 0.3810, Train Accuracy: 0.8586, Test Accuracy: 0.8236
Epoch 047/100, Train Loss: 0.3785, Train Accuracy: 0.8598, Test Accuracy: 0.8497
Epoch 048/100, Train Loss: 0.3847, Train Accuracy: 0.8591, Test Accuracy: 0.8558
Epoch 049/100, Train Loss: 0.3653, Train Accuracy: 0.8645, Test Accuracy: 0.8682
Epoch 050/100, Train Loss: 0.3635, Train Accuracy: 0.8658, Test Accuracy: 0.8325
Epoch 051/100, Train Loss: 0.3620, Train Accuracy: 0.8651, Test Accuracy: 0.8675
Epoch 052/100, Train Loss: 0.3569, Train Accuracy: 0.8674, Test Accuracy: 0.8718
Epoch 053/100, Train Loss: 2.7826, Train Accuracy: 0.6614, Test Accuracy: 0.1659
Epoch 054/100, Train Loss: 2.2073, Train Accuracy: 0.1513, Test Accuracy: 0.2216
Epoch 055/100, Train Loss: 1.7635, Train Accuracy: 0.3162, Test Accuracy: 0.3805
Epoch 056/100, Train Loss: 1.5522, Train Accuracy: 0.4165, Test Accuracy: 0.4127
Epoch 057/100, Train Loss: 1.4179, Train Accuracy: 0.4580, Test Accuracy: 0.4765
Epoch 058/100, Train Loss: 1.3843, Train Accuracy: 0.4728, Test Accuracy: 0.5049
Epoch 059/100, Train Loss: 1.3366, Train Accuracy: 0.4908, Test Accuracy: 0.5350
Epoch 060/100, Train Loss: 1.3040, Train Accuracy: 0.5013, Test Accuracy: 0.4623
Epoch 061/100, Train Loss: 1.2701, Train Accuracy: 0.5159, Test Accuracy: 0.4900
Epoch 062/100, Train Loss: 1.2507, Train Accuracy: 0.5143, Test Accuracy: 0.5222
Epoch 063/100, Train Loss: 1.2083, Train Accuracy: 0.5293, Test Accuracy: 0.5488
Epoch 064/100, Train Loss: 1.1823, Train Accuracy: 0.5404, Test Accuracy: 0.5293
Epoch 065/100, Train Loss: 1.1646, Train Accuracy: 0.5449, Test Accuracy: 0.5686
Epoch 066/100, Train Loss: 1.1377, Train Accuracy: 0.5527, Test Accuracy: 0.5657
Epoch 067/100, Train Loss: 1.1029, Train Accuracy: 0.5651, Test Accuracy: 0.6070
Epoch 068/100, Train Loss: 1.0533, Train Accuracy: 0.5830, Test Accuracy: 0.6221
Epoch 069/100, Train Loss: 0.9986, Train Accuracy: 0.6159, Test Accuracy: 0.6778
Epoch 070/100, Train Loss: 0.8880, Train Accuracy: 0.6602, Test Accuracy: 0.6481
Epoch 071/100, Train Loss: 0.8311, Train Accuracy: 0.6862, Test Accuracy: 0.7031
Epoch 072/100, Train Loss: 0.8117, Train Accuracy: 0.6930, Test Accuracy: 0.6910
Epoch 073/100, Train Loss: 0.7963, Train Accuracy: 0.7035, Test Accuracy: 0.7398
Epoch 074/100, Train Loss: 0.7548, Train Accuracy: 0.7157, Test Accuracy: 0.7411
Epoch 075/100, Train Loss: 0.7282, Train Accuracy: 0.7280, Test Accuracy: 0.7413
Epoch 076/100, Train Loss: 0.7239, Train Accuracy: 0.7321, Test Accuracy: 0.7209
Epoch 077/100, Train Loss: 0.7147, Train Accuracy: 0.7350, Test Accuracy: 0.7609
Epoch 078/100, Train Loss: 0.6934, Train Accuracy: 0.7454, Test Accuracy: 0.7665
Epoch 079/100, Train Loss: 0.6705, Train Accuracy: 0.7524, Test Accuracy: 0.7736
Epoch 080/100, Train Loss: 0.6627, Train Accuracy: 0.7564, Test Accuracy: 0.7749
Epoch 081/100, Train Loss: 0.6584, Train Accuracy: 0.7558, Test Accuracy: 0.7721
Epoch 082/100, Train Loss: 0.6431, Train Accuracy: 0.7624, Test Accuracy: 0.7721
Epoch 083/100, Train Loss: 0.6380, Train Accuracy: 0.7647, Test Accuracy: 0.7906
Epoch 084/100, Train Loss: 0.6190, Train Accuracy: 0.7732, Test Accuracy: 0.7784
Epoch 085/100, Train Loss: 0.6043, Train Accuracy: 0.7775, Test Accuracy: 0.7840
Epoch 086/100, Train Loss: 0.6054, Train Accuracy: 0.7755, Test Accuracy: 0.7757
Epoch 087/100, Train Loss: 0.5929, Train Accuracy: 0.7799, Test Accuracy: 0.7849
Epoch 088/100, Train Loss: 0.5797, Train Accuracy: 0.7831, Test Accuracy: 0.7871
Epoch 089/100, Train Loss: 0.5788, Train Accuracy: 0.7849, Test Accuracy: 0.7697
Epoch 090/100, Train Loss: 0.7270, Train Accuracy: 0.7399, Test Accuracy: 0.7937
Epoch 091/100, Train Loss: 0.5520, Train Accuracy: 0.7959, Test Accuracy: 0.8027
Epoch 092/100, Train Loss: 0.5473, Train Accuracy: 0.7959, Test Accuracy: 0.7947
Epoch 093/100, Train Loss: 0.5467, Train Accuracy: 0.7979, Test Accuracy: 0.8052
Epoch 094/100, Train Loss: 0.5392, Train Accuracy: 0.8003, Test Accuracy: 0.7986
Epoch 095/100, Train Loss: 0.5481, Train Accuracy: 0.7959, Test Accuracy: 0.7979
Epoch 096/100, Train Loss: 0.5203, Train Accuracy: 0.8073, Test Accuracy: 0.8072
Epoch 097/100, Train Loss: 0.5373, Train Accuracy: 0.8009, Test Accuracy: 0.8129
Epoch 098/100, Train Loss: 0.5107, Train Accuracy: 0.8102, Test Accuracy: 0.8115
Epoch 099/100, Train Loss: 0.5036, Train Accuracy: 0.8115, Test Accuracy: 0.8129
Epoch 100/100, Train Loss: 0.5054, Train Accuracy: 0.8130, Test Accuracy: 0.8014
Distributed environment cleaned up.
CUDA memory cache cleared.
Distributed environment cleaned up.
CUDA memory cache cleared.
Distributed environment cleaned up.
CUDA memory cache cleared.
Distributed environment cleaned up.
CUDA memory cache cleared.
